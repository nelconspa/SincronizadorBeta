import{_ as F,j as C,a as s,b as k,c as B,w as t,e as o,f as c,t as T,h as N,i as I,C as x,d as U,F as E,g as j}from"./index-BbNI8ARv.js";import{_ as H}from"./SearchFilter-CaQaq75L.js";import{i as P}from"./index-BlG5paJz.js";import{u as S,r as f,i as w}from"./index-Cr0WeISo.js";/* empty css                                                                 */import"./index-BivFdvbN.js";import"./index-8v7uM-YG.js";import"./index-DZlMe-le.js";const O={name:"AddConfig",setup(){return{v$:S()}},props:{showModal:Boolean},data(){return{form:{enabled:!1,client_id:null,client_config_id:null,schedule_id:null,zeusName:"",zeusCode:"",channelNivelFreatico:0,channelCaudal:0,channelTotalizador:0,channelAlturaLimnimetrica:0},schedules:[],configs:[],clients:[],selected:null,options:[],success:!1,fail:!1,successMsg:"",failMsg:""}},validations(){return{form:{client_id:{required:f},client_config_id:{required:f},schedule_id:{required:f},zeusName:{required:f},zeusCode:{required:f},dgaCode:{required:f},channelCaudal:{required:f},channelAlturaLimnimetrica:{integer:w},channelTotalizador:{integer:w}}}},mounted(){this.getClients(),this.getSchedules()},watch:{showModal(e){e||this.$emit("update:showModal",!1)}},methods:{getCodesConfig(){},setTouched(e){(e=="client_id"||e=="all")&&this.v$.form.client_id.$touch(),(e=="client_config_id"||e=="all")&&this.v$.form.client_config_id.$touch(),(e=="schedule_id"||e=="all")&&this.v$.form.schedule_id.$touch(),(e=="zeusName"||e=="all")&&this.v$.form.zeusName.$touch(),(e=="zeusCode"||e=="all")&&this.v$.form.zeusCode.$touch(),(e=="dgaCode"||e=="all")&&this.v$.form.dgaCode.$touch(),(e=="channelCaudal"||e=="all")&&this.v$.form.channelCaudal.$touch(),(e=="channelAlturaLimnimetrica"||e=="all")&&this.v$.form.channelAlturaLimnimetrica.$touch(),(e=="channelTotalizador"||e=="all")&&this.v$.form.channelTotalizador.$touch()},restoreInitialData(){this.fail=!1,this.success=!1,this.failMsg="",this.successMsg=""},closeModal(){this.restoreInitialData(),this.$emit("cerrar")},closeModalOutside(e){document.querySelector(".modal-class").contains(e.target)||(console.log("Entra al if"),this.closeModal())},async getSchedules(){try{const e=await C.get(this.$store.state.backendUrl+"/schedules",{headers:{"Content-Type":"application/json",Authorization:"Bearer "+this.$store.state.token}});this.schedules=e.data,console.log(this.schedules[0])}catch(e){console.error("Error en la solicitud a la API:",e),this.ShowError=!0}},async getClients(){try{const e=await C.get(this.$store.state.backendUrl+"/clients",{headers:{"Content-Type":"application/json",Authorization:"Bearer "+this.$store.state.token}});this.clients=e.data}catch(e){console.error("Error en la solicitud a la API:",e),this.ShowError=!0}},getUserConfig(e){C.get(this.$store.state.backendUrl+"/client_configs",{params:{client_id:e},headers:{"Content-Type":"application/json",Authorization:"Bearer "+this.$store.state.token}}).then(l=>{this.configs=l.data,console.log("configs: ",this.configs)}).catch(l=>{console.error("Error en la solicitud a la API:",l),this.ShowError=!0})},async saveDevice(){if(this.setTouched("all"),!this.v$.$invalid)try{const e=await C.post(this.$store.state.backendUrl+"/devices",this.form,{headers:{"Content-Type":"application/json",Authorization:"Bearer "+this.$store.state.token}});console.log(e),this.successMsg="Dispositivo añadido exitósamente.",this.success=!0,setTimeout(()=>{this.closeModal()},2e3)}catch(e){if(e.response){const l=e.response.data.errors;for(const h in l)if(l.hasOwnProperty(h)){const d=l[h];this.failMsg=this.failMsg.concat(d,`
`),this.fail=!0,setTimeout(()=>{this.restoreInitialData()},2e3)}}}}}},G=N("label",{class:"mb-2"},"Seleccionar cliente",-1),Z=N("label",{class:"mb-2"},"Seleccionar configuración",-1),q=N("label",{class:"mb-2"},"Seleccionar periodicidad ",-1);function J(e,l,h,d,i,n){const z=s("CModalTitle"),_=s("CModalHeader"),v=s("CAlert"),b=s("CFormCheck"),r=s("CCol"),m=s("v-select"),u=s("CFormInput"),D=s("CRow"),p=s("CForm"),M=s("CModalBody"),g=s("CButton"),V=s("CModalFooter"),A=s("CModal");return k(),B(A,{size:"lg",class:"modal-class",visible:h.showModal,onClose:n.closeModal},{default:t(()=>[o(_,null,{default:t(()=>[o(z,null,{default:t(()=>[c("Agregar nuevo dispositivo")]),_:1})]),_:1}),o(M,null,{default:t(()=>[o(v,{color:"success",visible:i.success},{default:t(()=>[c(T(i.successMsg),1)]),_:1},8,["visible"]),o(v,{color:"danger",visible:i.fail},{default:t(()=>[c(T(i.failMsg),1)]),_:1},8,["visible"]),o(p,null,{default:t(()=>[o(D,null,{default:t(()=>[o(r,{class:"col-12"},{default:t(()=>[o(b,{modelValue:i.form.enabled,"onUpdate:modelValue":l[0]||(l[0]=a=>i.form.enabled=a),label:"Habilitado",class:"mr-5"},null,8,["modelValue"])]),_:1}),o(r,{class:"col-12 mt-4"},{default:t(()=>[G,o(m,{modelValue:i.form.client_id,"onUpdate:modelValue":l[1]||(l[1]=a=>i.form.client_id=a),options:i.clients,reduce:a=>a.id,"onOption:selected":n.getUserConfig,placeholder:"Seleccione...",label:"name",onInput:l[2]||(l[2]=a=>n.setTouched("client_id")),feedback:"Rellene este campo por favor.",invalid:d.v$.form.client_id.$error},null,8,["modelValue","options","reduce","onOption:selected","invalid"])]),_:1}),o(r,{class:"col-6 mt-4"},{default:t(()=>[Z,o(m,{modelValue:i.form.client_config_id,"onUpdate:modelValue":l[3]||(l[3]=a=>i.form.client_config_id=a),options:i.configs,reduce:a=>a.id,placeholder:"Seleccione...",label:"dgaUsername","onOption:selected":n.getCodesConfig,onInput:l[4]||(l[4]=a=>n.setTouched("client_config_id")),feedback:"Rellene este campo por favor.",invalid:d.v$.form.client_config_id.$error},null,8,["modelValue","options","reduce","onOption:selected","invalid"])]),_:1}),o(r,{class:"col-6 mt-4"},{default:t(()=>[q,o(m,{modelValue:i.form.schedule_id,"onUpdate:modelValue":l[5]||(l[5]=a=>i.form.schedule_id=a),options:i.schedules,reduce:a=>a.id,searchable:!0,label:"name",placeholder:"Seleccione",onInput:l[6]||(l[6]=a=>n.setTouched("schedule_id")),feedback:"Rellene este campo por favor.",invalid:d.v$.form.schedule_id.$error},null,8,["modelValue","options","reduce","invalid"])]),_:1}),o(r,{class:"col-12 mt-4"},{default:t(()=>[o(u,{label:"Nombre",type:"text",placeholder:"Nombre","aria-describedby":"nombre",modelValue:i.form.zeusName,"onUpdate:modelValue":l[7]||(l[7]=a=>i.form.zeusName=a),onInput:l[8]||(l[8]=a=>n.setTouched("zeusName")),feedback:"Rellene este campo por favor.",invalid:d.v$.form.zeusName.$error},null,8,["modelValue","invalid"])]),_:1}),o(r,{class:"col-6 mt-4"},{default:t(()=>[o(u,{label:"Zeus Código",type:"text",placeholder:"Zeus código","aria-describedby":"Zeus código",modelValue:i.form.zeusCode,"onUpdate:modelValue":l[9]||(l[9]=a=>i.form.zeusCode=a),onInput:l[10]||(l[10]=a=>n.setTouched("zeusCode")),feedback:"Rellene este campo por favor.",invalid:d.v$.form.zeusCode.$error},null,8,["modelValue","invalid"])]),_:1}),o(r,{class:"col-6 mt-4"},{default:t(()=>[o(u,{label:"DGA Código",type:"text",placeholder:"DGA código","aria-describedby":"DGA código",modelValue:i.form.dgaCode,"onUpdate:modelValue":l[11]||(l[11]=a=>i.form.dgaCode=a),onInput:l[12]||(l[12]=a=>n.setTouched("dgaCode")),feedback:"Rellene este campo por favor.",invalid:d.v$.form.dgaCode.$error},null,8,["modelValue","invalid"])]),_:1}),o(r,{class:"col-4 mt-4"},{default:t(()=>[o(u,{label:"Canal: Nivel Freático",type:"number",placeholder:"Canal: Nivel Freático","aria-describedby":"Nivel Freático",modelValue:i.form.channelNivelFreatico,"onUpdate:modelValue":l[13]||(l[13]=a=>i.form.channelNivelFreatico=a)},null,8,["modelValue"])]),_:1}),o(r,{class:"col-4 mt-4"},{default:t(()=>[o(u,{label:"Canal: Caudal",type:"number",placeholder:"Canal: Caudal","aria-describedby":"Caudal",modelValue:i.form.channelCaudal,"onUpdate:modelValue":l[14]||(l[14]=a=>i.form.channelCaudal=a),onInput:l[15]||(l[15]=a=>n.setTouched("channelCaudal")),feedback:"Rellene este campo por favor.",invalid:d.v$.form.channelCaudal.$error},null,8,["modelValue","invalid"])]),_:1}),o(r,{class:"col-4 mt-4"},{default:t(()=>[o(u,{label:"Canal: Totalizador",type:"number",placeholder:"Canal: Totalizador","aria-describedby":"Totalizador",modelValue:i.form.channelTotalizador,"onUpdate:modelValue":l[16]||(l[16]=a=>i.form.channelTotalizador=a),onInput:l[17]||(l[17]=a=>n.setTouched("channelTotalizador")),feedback:"Rellene este campo por favor.",invalid:d.v$.form.channelTotalizador.$error},null,8,["modelValue","invalid"])]),_:1}),o(r,{class:"col-6 mt-4"},{default:t(()=>[o(u,{label:"Canal: Altura Limnimétrica",type:"number",placeholder:"Canal: Altura limnimétrica","aria-describedby":"Altura Limnimétrica",modelValue:i.form.channelAlturaLimnimetrica,"onUpdate:modelValue":l[18]||(l[18]=a=>i.form.channelAlturaLimnimetrica=a),onInput:l[19]||(l[19]=a=>n.setTouched("channelAlturaLimnimetrica")),feedback:"Rellene este campo por favor.",invalid:d.v$.form.channelAlturaLimnimetrica.$error},null,8,["modelValue","invalid"])]),_:1})]),_:1})]),_:1})]),_:1}),o(V,null,{default:t(()=>[o(g,{color:"secondary",onClick:n.closeModal},{default:t(()=>[c(" Cerrar ")]),_:1},8,["onClick"]),o(g,{color:"primary",onClick:n.saveDevice},{default:t(()=>[c("Guardar")]),_:1},8,["onClick"])]),_:1})]),_:1},8,["visible","onClose"])}const K=F(O,[["render",J]]),Q={name:"AddConfig",props:{showModal:Boolean,device:Object},setup(){return{v$:S()}},data(){return{form:{id:"",enabled:!1,client_id:"",client_config_id:"",zeusCode:"",zeusName:"",dgaCode:"",channelNivelFreatico:"",channelCaudal:"",channelTotalizador:"",channelAlturaLimnimetrica:""},schedules:[],configs:[],configsByClient:[],clients:[],successMsg:"",success:!1,fail:!1,failMsg:""}},validations(){return{form:{client_id:{required:f},client_config_id:{required:f},schedule_id:{required:f},zeusName:{required:f},zeusCode:{required:f},dgaCode:{required:f},channelCaudal:{required:f},channelAlturaLimnimetrica:{integer:w},channelTotalizador:{integer:w}}}},watch:{device:{handler(e){this.setDataDevice(e)},deep:!0,immediate:!0},showModal(e){e||this.$emit("update:showModal",!1)}},mounted(){this.getUsersConfig(),this.getSchedules(),this.getClients()},methods:{setTouched(e){(e=="client_id"||e=="all")&&this.v$.form.client_id.$touch(),(e=="client_config_id"||e=="all")&&this.v$.form.client_config_id.$touch(),(e=="schedule_id"||e=="all")&&this.v$.form.schedule_id.$touch(),(e=="zeusName"||e=="all")&&this.v$.form.zeusName.$touch(),(e=="zeusCode"||e=="all")&&this.v$.form.zeusCode.$touch(),(e=="dgaCode"||e=="all")&&this.v$.form.dgaCode.$touch(),(e=="channelCaudal"||e=="all")&&this.v$.form.channelCaudal.$touch(),(e=="channelAlturaLimnimetrica"||e=="all")&&this.v$.form.channelAlturaLimnimetrica.$touch(),(e=="channelTotalizador"||e=="all")&&this.v$.form.channelTotalizador.$touch()},restoreInitialData(){this.fail=!1,this.success=!1,this.failMsg="",this.successMsg=""},closeModal(){this.restoreInitialData(),this.$emit("cerrar"),this.success=!1},closeModalOutside(e){e.target===e.currentTarget&&this.closeModal()},setDataDevice(e){e&&(this.form.id=e.id,this.form.client_id=e.client_id,this.form.schedule_id=e.schedule_id,this.form.client_config_id=e.client_config_id,this.form.name=e.name,this.form.zeusCode=e.zeusCode,this.form.zeusName=e.zeusName,this.form.dgaCode=e.dgaCode,this.form.channelNivelFreatico=e.channelNivelFreatico,this.form.channelCaudal=e.channelCaudal,this.form.channelTotalizador=e.channelTotalizador,this.form.channelAlturaLimnimetrica=e.channelAlturaLimnimetrica,this.form.enabled=e.enabled,this.getConfigByClient(this.form.client_id))},async getSchedules(){try{const e=await C.get(this.$store.state.backendUrl+"/schedules",{headers:{"Content-Type":"application/json",Authorization:"Bearer "+this.$store.state.token}});this.schedules=e.data,console.log(this.schedules[0])}catch(e){console.error("Error en la solicitud a la API:",e),this.ShowError=!0}},async getUsersConfig(){try{const e=await C.get(this.$store.state.backendUrl+"/client_configs",{params:{client:1},headers:{"Content-Type":"application/json",Authorization:"Bearer "+this.$store.state.token}});this.configs=e.data.map(l=>({...l,clientName:l.client.name})),console.log(this.configs[0])}catch(e){console.error("Error en la solicitud a la API:",e),this.ShowError=!0}},async getConfigByClient(e){try{const l=await C.get(this.$store.state.backendUrl+"/client_configs",{params:{client:1,client_id:e},headers:{"Content-Type":"application/json",Authorization:"Bearer "+this.$store.state.token}});this.configsByClient=l.data,console.log(this.configsByClient)}catch(l){console.error("Error en la solicitud a la API:",l),this.ShowError=!0}},async getClients(){try{const e=await C.get(this.$store.state.backendUrl+"/clients",{headers:{"Content-Type":"application/json",Authorization:"Bearer "+this.$store.state.token}});this.clients=e.data}catch(e){console.error("Error en la solicitud a la API:",e),this.ShowError=!0}},saveDevice(){if(this.setTouched("all"),!this.v$.$invalid)try{const e=C.put(this.$store.state.backendUrl+"/devices/"+this.form.id,this.form,{headers:{"Content-Type":"application/json",Authorization:"Bearer "+this.$store.state.token}});console.log(e),this.successMsg="Dispositivo actualizado exitósamente.",this.success=!0,setTimeout(()=>{this.closeModal()},2e3)}catch(e){if(e.response){const l=e.response.data.errors;for(const h in l)if(l.hasOwnProperty(h)){const d=l[h];this.failMsg=this.failMsg.concat(d,`
`),this.fail=!0,setTimeout(()=>{this.restoreInitialData()},2e3)}}}}}};function W(e,l,h,d,i,n){const z=s("CModalTitle"),_=s("CModalHeader"),v=s("CAlert"),b=s("CFormCheck"),r=s("CCol"),m=s("v-select"),u=s("CFormInput"),D=s("CRow"),p=s("CForm"),M=s("CModalBody"),g=s("CButton"),V=s("CModalFooter"),A=s("CModal");return k(),B(A,{size:"lg",visible:h.showModal,onClick:n.closeModalOutside},{default:t(()=>[o(_,null,{default:t(()=>[o(z,null,{default:t(()=>[c("Editar dispositivo")]),_:1})]),_:1}),o(M,null,{default:t(()=>[o(v,{color:"success",visible:i.success},{default:t(()=>[c(T(i.successMsg),1)]),_:1},8,["visible"]),o(p,null,{default:t(()=>[o(D,null,{default:t(()=>[o(r,{class:"col-12"},{default:t(()=>[o(b,{label:"Habilitado",class:"mr-5",modelValue:i.form.enabled,"onUpdate:modelValue":l[0]||(l[0]=a=>i.form.enabled=a)},null,8,["modelValue"])]),_:1}),o(r,{class:"col-12 mt-4"},{default:t(()=>[o(m,{modelValue:i.form.client_id,"onUpdate:modelValue":l[1]||(l[1]=a=>i.form.client_id=a),options:i.clients,reduce:a=>a.id,label:"name",placeholder:"Seleccione...",onInput:l[2]||(l[2]=a=>n.setTouched("client_id")),feedback:"Rellene este campo por favor.",invalid:d.v$.form.client_id.$error},null,8,["modelValue","options","reduce","invalid"])]),_:1}),o(r,{class:"col-6 mt-4"},{default:t(()=>[o(m,{modelValue:i.form.client_config_id,"onUpdate:modelValue":l[3]||(l[3]=a=>i.form.client_config_id=a),options:i.configsByClient,reduce:a=>a.id,placeholder:"Seleccione...",label:"zeusHost",onInput:l[4]||(l[4]=a=>n.setTouched("client_config_id")),feedback:"Rellene este campo por favor.",invalid:d.v$.form.client_config_id.$error},null,8,["modelValue","options","reduce","invalid"])]),_:1}),o(r,{class:"col-6 mt-4"},{default:t(()=>[o(m,{modelValue:i.form.schedule_id,"onUpdate:modelValue":l[5]||(l[5]=a=>i.form.schedule_id=a),options:i.schedules,reduce:a=>a.id,label:"name",placeholder:"Seleccione...",onInput:l[6]||(l[6]=a=>n.setTouched("schedule_id")),feedback:"Rellene este campo por favor.",invalid:d.v$.form.schedule_id.$error},null,8,["modelValue","options","reduce","invalid"])]),_:1}),o(r,{class:"col-12 mt-4"},{default:t(()=>[o(u,{label:"Nombre",type:"text",placeholder:"Nombre","aria-describedby":"nombre",modelValue:i.form.zeusName,"onUpdate:modelValue":l[7]||(l[7]=a=>i.form.zeusName=a),onInput:l[8]||(l[8]=a=>n.setTouched("zeusName")),feedback:"Rellene este campo por favor.",invalid:d.v$.form.zeusName.$error},null,8,["modelValue","invalid"])]),_:1}),o(r,{class:"col-6 mt-4"},{default:t(()=>[o(u,{label:"Zeus Código",type:"text",placeholder:"Zeus código","aria-describedby":"Zeus código",modelValue:i.form.zeusCode,"onUpdate:modelValue":l[9]||(l[9]=a=>i.form.zeusCode=a),onInput:l[10]||(l[10]=a=>n.setTouched("zeusCode")),feedback:"Rellene este campo por favor.",invalid:d.v$.form.zeusCode.$error},null,8,["modelValue","invalid"])]),_:1}),o(r,{class:"col-6 mt-4"},{default:t(()=>[o(u,{label:"DGA Código",type:"text",placeholder:"DGA código","aria-describedby":"DGA código",modelValue:i.form.dgaCode,"onUpdate:modelValue":l[11]||(l[11]=a=>i.form.dgaCode=a),onInput:l[12]||(l[12]=a=>n.setTouched("dgaCode")),feedback:"Rellene este campo por favor.",invalid:d.v$.form.dgaCode.$error},null,8,["modelValue","invalid"])]),_:1}),o(r,{class:"col-4 mt-4"},{default:t(()=>[o(u,{label:"Canal: Nivel Freático",type:"text",placeholder:"Canal: Nivel Freático","aria-describedby":"Nivel Freático",modelValue:i.form.channelNivelFreatico,"onUpdate:modelValue":l[13]||(l[13]=a=>i.form.channelNivelFreatico=a)},null,8,["modelValue"])]),_:1}),o(r,{class:"col-4 mt-4"},{default:t(()=>[o(u,{label:"Canal: Caudal",type:"text",placeholder:"Canal: Caudal","aria-describedby":"Caudal",modelValue:i.form.channelCaudal,"onUpdate:modelValue":l[14]||(l[14]=a=>i.form.channelCaudal=a),onInput:l[15]||(l[15]=a=>n.setTouched("channelCaudal")),feedback:"Rellene este campo por favor.",invalid:d.v$.form.channelCaudal.$error},null,8,["modelValue","invalid"])]),_:1}),o(r,{class:"col-4 mt-4"},{default:t(()=>[o(u,{label:"Canal: Totalizador",type:"text",placeholder:"Canal: Totalizador","aria-describedby":"Totalizador",modelValue:i.form.channelTotalizador,"onUpdate:modelValue":l[16]||(l[16]=a=>i.form.channelTotalizador=a),onInput:l[17]||(l[17]=a=>n.setTouched("channelTotalizador")),feedback:"Rellene este campo por favor.",invalid:d.v$.form.channelTotalizador.$error},null,8,["modelValue","invalid"])]),_:1}),o(r,{class:"col-4 mt-4"},{default:t(()=>[o(u,{label:"Canal: Altura Limnimétrica",type:"text",placeholder:"Canal: Altura limnimétrica","aria-describedby":"limnimetrica",modelValue:i.form.channelAlturaLimnimetrica,"onUpdate:modelValue":l[18]||(l[18]=a=>i.form.channelAlturaLimnimetrica=a),onInput:l[19]||(l[19]=a=>n.setTouched("channelAlturaLimnimetrica")),feedback:"Rellene este campo por favor.",invalid:d.v$.form.channelAlturaLimnimetrica.$error},null,8,["modelValue","invalid"])]),_:1})]),_:1})]),_:1})]),_:1}),o(V,null,{default:t(()=>[o(g,{color:"secondary",onClick:n.closeModal},{default:t(()=>[c(" Cerrar ")]),_:1},8,["onClick"]),o(g,{color:"primary",onClick:n.saveDevice},{default:t(()=>[c("Guardar")]),_:1},8,["onClick"])]),_:1})]),_:1},8,["visible","onClick"])}const X=F(Q,[["render",W]]),Y={name:"DeleteModal",emits:["closeDeleteModal"],props:{showDeleteModal:Boolean,device:Object},data(){return{fail:!1,success:!1}},methods:{closeModal(){this.$emit("closeDeleteModal"),this.fail=!1,this.success=!1},deleteDevice(){this.device.enabled&&(this.fail=!0),this.fail||C.delete(this.$store.state.backendUrl+"/devices/"+this.devices.id,{headers:{"Content-Type":"application/json",Authorization:"Bearer "+this.$store.state.token}}).then(e=>{console.log(e),this.success=!0}).catch(e=>{console.log("Error: ",e)})}}};function ee(e,l,h,d,i,n){const z=s("CModalTitle"),_=s("CModalHeader"),v=s("CModalBody"),b=s("CAlert"),r=s("CButton"),m=s("CModalFooter"),u=s("CModal");return k(),B(u,{visible:h.showDeleteModal,onClose:n.closeModal},{default:t(()=>[o(_,null,{default:t(()=>[o(z,null,{default:t(()=>[I(e.$slots,"modalTitle")]),_:3})]),_:3}),o(v,null,{default:t(()=>[I(e.$slots,"modalBody")]),_:3}),o(m,null,{default:t(()=>[o(b,{color:"danger",visible:i.fail},{default:t(()=>[c(" Para eliminar este dispositivo no debe estar habilitado. ")]),_:1},8,["visible"]),o(b,{color:"success",visible:i.success},{default:t(()=>[c(" Dispositivo eliminado exitósamente. ")]),_:1},8,["visible"]),o(r,{onClick:n.deleteDevice,color:"danger",class:"text-white"},{default:t(()=>[c("Eliminar ")]),_:1},8,["onClick"]),o(r,{color:"primary",onClick:n.closeModal},{default:t(()=>[c("Cancelar")]),_:1},8,["onClick"])]),_:1})]),_:3},8,["visible","onClose"])}const le=F(Y,[["render",ee]]),oe={name:"Devices",components:{SearchBarFilter:H,CIcon:x,AddDeviceModal:K,EditDeviceModal:X,DeleteDeviceModal:le},setup(){return{icon:P}},data(){return{devices:[],searchFilter:"",status:!1,showAddModal:!1,showEditModal:!1,showDeleteModal:!1,device_id:null}},computed:{filteredDevices(){let e=this.devices;return this.searchFilter!==""&&(e=e.filter(l=>l.zeusName.toLowerCase().includes(this.searchFilter.toLowerCase())||l.zeusCode.toLowerCase().includes(this.searchFilter.toLowerCase())||l.dgaCode.toLowerCase().includes(this.searchFilter.toLowerCase())||l.client.name.toLowerCase().includes(this.searchFilter.toLowerCase()))),e}},mounted(){this.getDevices()},methods:{handleSearch(e){this.searchFilter=e},editDevice(e){this.showEditModal=!0,this.device_id=e},deleteDevice(e){this.showDeleteModal=!0,this.device_id=e},addDevice(){this.showAddModal=!0},async getDevices(){try{const e=await C.get(this.$store.state.backendUrl+"/devices",{params:{client:1},headers:{"Content-Type":"application/json",Authorization:"Bearer "+this.$store.state.token}});this.devices=e.data,console.log("DEVICES: ",this.devices)}catch(e){console.error("Error en la solicitud a la API:",e),this.ShowError=!0}},onCloseAdd(){this.showAddModal=!1,this.getDevices()},onCloseEdit(){this.showEditModal=!1,this.getDevices()},onCloseDeleteModal(){this.showDeleteModal=!1,this.getDevices()}}};function te(e,l,h,d,i,n){const z=s("CIcon"),_=s("CButton"),v=s("CCol"),b=s("SearchBarFilter"),r=s("CRow"),m=s("CTableHeaderCell"),u=s("CTableRow"),D=s("CTableHead"),p=s("CTableDataCell"),M=s("CFormCheck"),g=s("font-awesome-icon"),V=s("CTableBody"),A=s("CTable"),a=s("AddDeviceModal"),L=s("EditDeviceModal"),R=s("DeleteDeviceModal");return k(),U(E,null,[o(r,{class:"mb-4"},{default:t(()=>[o(v,{class:"col-3 mt-4"},{default:t(()=>[o(_,{onClick:n.addDevice,color:"success",shape:"rounded-pill",variant:"outline"},{default:t(()=>[o(z,{icon:d.icon.cilPlus,size:"xl"},null,8,["icon"])]),_:1},8,["onClick"])]),_:1}),o(v,{class:"col-9"},{default:t(()=>[o(b,{onSearch:n.handleSearch},null,8,["onSearch"])]),_:1})]),_:1}),o(A,{class:"mt-5"},{default:t(()=>[o(D,null,{default:t(()=>[o(u,{color:"dark"},{default:t(()=>[o(m,{scope:"col"},{default:t(()=>[c("Cliente")]),_:1}),o(m,{scope:"col"},{default:t(()=>[c("Zeus Nombre")]),_:1}),o(m,{scope:"col"},{default:t(()=>[c("Zeus Código")]),_:1}),o(m,{scope:"col"},{default:t(()=>[c("DGA Código")]),_:1}),o(m,{scope:"col"},{default:t(()=>[c("Habilitado")]),_:1}),o(m,{scope:"col"},{default:t(()=>[c("Editar")]),_:1})]),_:1})]),_:1}),o(V,null,{default:t(()=>[(k(!0),U(E,null,j(n.filteredDevices,(y,ae)=>(k(),B(u,{key:y.id},{default:t(()=>[o(p,null,{default:t(()=>[c(T(y.client.name),1)]),_:2},1024),o(p,null,{default:t(()=>[c(T(y.zeusName),1)]),_:2},1024),o(p,null,{default:t(()=>[c(T(y.zeusCode),1)]),_:2},1024),o(p,null,{default:t(()=>[c(T(y.dgaCode),1)]),_:2},1024),o(p,{class:"text-center"},{default:t(()=>[o(M,{checked:y.enabled,disabled:""},null,8,["checked"])]),_:2},1024),o(p,null,{default:t(()=>[o(_,{onClick:$=>n.editDevice(y)},{default:t(()=>[o(g,{icon:"pen-to-square",size:"xl"})]),_:2},1032,["onClick"]),o(_,{onClick:$=>n.deleteDevice(y)},{default:t(()=>[o(g,{icon:"trash",size:"xl"})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),o(a,{showModal:i.showAddModal,onCerrar:n.onCloseAdd},null,8,["showModal","onCerrar"]),o(L,{showModal:i.showEditModal,device:i.device_id,onCerrar:n.onCloseEdit},null,8,["showModal","device","onCerrar"]),o(R,{showDeleteModal:i.showDeleteModal,onCloseDeleteModal:n.onCloseDeleteModal,device:i.device_id},{modalTitle:t(()=>[c("Eliminar dispositivo: "),N("b",null,T(i.device_id.zeusName),1)]),modalBody:t(()=>[c(" ADVERTENCIA: Se eliminarán todos los datos de este dispositivo. ")]),modalFooter:t(()=>[]),_:1},8,["showDeleteModal","onCloseDeleteModal","device"])],64)}const fe=F(oe,[["render",te]]);export{fe as default};
