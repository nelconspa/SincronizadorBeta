import{_ as F,j as h,a as i,b as k,c as B,w as t,e as o,f as d,t as T,h as N,i as E,C as x,d as U,F as I,g as j}from"./index-3SSTsJ3w.js";import{_ as H}from"./SearchFilter-Dr4j4Hqn.js";import{i as P}from"./index-BnC7c4vR.js";import{u as S,r as f,i as w}from"./index-CA4yEEAx.js";/* empty css                                                                 */import"./index-t518_D9j.js";import"./index-N1Wu2ibn.js";import"./index-DnIuxDsE.js";const G={name:"AddConfig",setup(){return{v$:S()}},props:{showModal:Boolean},data(){return{form:{enabled:!1,client_id:null,client_config_id:null,schedule_id:null,zeusName:"",zeusCode:"",channelNivelFreatico:0,channelCaudal:0,channelTotalizador:0,channelAlturaLimnimetrica:0},schedules:[],configs:[],clients:[],selected:null,options:[],success:!1,successMsg:""}},validations(){return{form:{client_id:{required:f},client_config_id:{required:f},schedule_id:{required:f},zeusName:{required:f},zeusCode:{required:f},dgaCode:{required:f},channelCaudal:{required:f},channelAlturaLimnimetrica:{integer:w},channelTotalizador:{integer:w}}}},mounted(){this.getClients(),this.getSchedules()},watch:{showModal(e){e||this.$emit("update:showModal",!1)}},methods:{getCodesConfig(){},setTouched(e){(e=="client_id"||e=="all")&&this.v$.form.client_id.$touch(),(e=="client_config_id"||e=="all")&&this.v$.form.client_config_id.$touch(),(e=="schedule_id"||e=="all")&&this.v$.form.schedule_id.$touch(),(e=="zeusName"||e=="all")&&this.v$.form.zeusName.$touch(),(e=="zeusCode"||e=="all")&&this.v$.form.zeusCode.$touch(),(e=="dgaCode"||e=="all")&&this.v$.form.dgaCode.$touch(),(e=="channelCaudal"||e=="all")&&this.v$.form.channelCaudal.$touch(),(e=="channelAlturaLimnimetrica"||e=="all")&&this.v$.form.channelAlturaLimnimetrica.$touch(),(e=="channelTotalizador"||e=="all")&&this.v$.form.channelTotalizador.$touch()},closeModal(){console.log("Cerrandose modal"),this.$emit("cerrar"),this.success=!1},closeModalOutside(e){console.log("Cerrándose modal en funcion2"),document.querySelector(".modal-class").contains(e.target)||(console.log("Entra al if"),this.closeModal())},async getSchedules(){try{const e=await h.get(this.$store.state.backendUrl+"/schedules",{headers:{"Content-Type":"application/json",Authorization:"Bearer "+this.$store.state.token}});this.schedules=e.data,console.log(this.schedules[0])}catch(e){console.error("Error en la solicitud a la API:",e),this.ShowError=!0}},async getClients(){try{const e=await h.get(this.$store.state.backendUrl+"/clients",{headers:{"Content-Type":"application/json",Authorization:"Bearer "+this.$store.state.token}});this.clients=e.data}catch(e){console.error("Error en la solicitud a la API:",e),this.ShowError=!0}},getUserConfig(e){h.get(this.$store.state.backendUrl+"/client_configs",{params:{client_id:e},headers:{"Content-Type":"application/json",Authorization:"Bearer "+this.$store.state.token}}).then(l=>{this.configs=l.data,console.log("configs: ",this.configs)}).catch(l=>{console.error("Error en la solicitud a la API:",l),this.ShowError=!0})},saveDevice(){this.setTouched("all"),this.v$.$invalid||h.post(this.$store.state.backendUrl+"/devices",this.form,{headers:{"Content-Type":"application/json",Authorization:"Bearer "+this.$store.state.token}}).then(e=>{console.log(e),this.successMsg="Dispositivo añadido exitósamente.",this.success=!0}).catch(e=>{console.log("Error en post: ",e)})}}},O=N("label",{class:"mb-2"},"Seleccionar cliente",-1),Z=N("label",{class:"mb-2"},"Seleccionar configuración",-1),q=N("label",{class:"mb-2"},"Seleccionar periodicidad ",-1);function J(e,l,y,c,n,s){const z=i("CModalTitle"),p=i("CModalHeader"),_=i("CAlert"),v=i("CFormCheck"),r=i("CCol"),m=i("v-select"),u=i("CFormInput"),V=i("CRow"),C=i("CForm"),A=i("CModalBody"),b=i("CButton"),D=i("CModalFooter"),M=i("CModal");return k(),B(M,{size:"lg",class:"modal-class",visible:y.showModal,onClose:s.closeModal},{default:t(()=>[o(p,null,{default:t(()=>[o(z,null,{default:t(()=>[d("Agregar nuevo dispositivo")]),_:1})]),_:1}),o(A,null,{default:t(()=>[o(_,{color:"success",visible:n.success},{default:t(()=>[d(T(n.successMsg),1)]),_:1},8,["visible"]),o(C,null,{default:t(()=>[o(V,null,{default:t(()=>[o(r,{class:"col-12"},{default:t(()=>[o(v,{modelValue:n.form.enabled,"onUpdate:modelValue":l[0]||(l[0]=a=>n.form.enabled=a),label:"Habilitado",class:"mr-5"},null,8,["modelValue"])]),_:1}),o(r,{class:"col-12 mt-4"},{default:t(()=>[O,o(m,{modelValue:n.form.client_id,"onUpdate:modelValue":l[1]||(l[1]=a=>n.form.client_id=a),options:n.clients,reduce:a=>a.id,"onOption:selected":s.getUserConfig,placeholder:"Seleccione...",label:"name",onInput:l[2]||(l[2]=a=>s.setTouched("client_id")),feedback:"Rellene este campo por favor.",invalid:c.v$.form.client_id.$error},null,8,["modelValue","options","reduce","onOption:selected","invalid"])]),_:1}),o(r,{class:"col-6 mt-4"},{default:t(()=>[Z,o(m,{modelValue:n.form.client_config_id,"onUpdate:modelValue":l[3]||(l[3]=a=>n.form.client_config_id=a),options:n.configs,reduce:a=>a.id,placeholder:"Seleccione...",label:"dgaUsername","onOption:selected":s.getCodesConfig,onInput:l[4]||(l[4]=a=>s.setTouched("client_config_id")),feedback:"Rellene este campo por favor.",invalid:c.v$.form.client_config_id.$error},null,8,["modelValue","options","reduce","onOption:selected","invalid"])]),_:1}),o(r,{class:"col-6 mt-4"},{default:t(()=>[q,o(m,{modelValue:n.form.schedule_id,"onUpdate:modelValue":l[5]||(l[5]=a=>n.form.schedule_id=a),options:n.schedules,reduce:a=>a.id,searchable:!0,label:"name",placeholder:"Seleccione",onInput:l[6]||(l[6]=a=>s.setTouched("schedule_id")),feedback:"Rellene este campo por favor.",invalid:c.v$.form.schedule_id.$error},null,8,["modelValue","options","reduce","invalid"])]),_:1}),o(r,{class:"col-12 mt-4"},{default:t(()=>[o(u,{label:"Nombre",type:"text",placeholder:"Nombre","aria-describedby":"nombre",modelValue:n.form.zeusName,"onUpdate:modelValue":l[7]||(l[7]=a=>n.form.zeusName=a),onInput:l[8]||(l[8]=a=>s.setTouched("zeusName")),feedback:"Rellene este campo por favor.",invalid:c.v$.form.zeusName.$error},null,8,["modelValue","invalid"])]),_:1}),o(r,{class:"col-6 mt-4"},{default:t(()=>[o(u,{label:"Zeus Código",type:"text",placeholder:"Zeus código","aria-describedby":"Zeus código",modelValue:n.form.zeusCode,"onUpdate:modelValue":l[9]||(l[9]=a=>n.form.zeusCode=a),onInput:l[10]||(l[10]=a=>s.setTouched("zeusCode")),feedback:"Rellene este campo por favor.",invalid:c.v$.form.zeusCode.$error},null,8,["modelValue","invalid"])]),_:1}),o(r,{class:"col-6 mt-4"},{default:t(()=>[o(u,{label:"DGA Código",type:"text",placeholder:"DGA código","aria-describedby":"DGA código",modelValue:n.form.dgaCode,"onUpdate:modelValue":l[11]||(l[11]=a=>n.form.dgaCode=a),onInput:l[12]||(l[12]=a=>s.setTouched("dgaCode")),feedback:"Rellene este campo por favor.",invalid:c.v$.form.dgaCode.$error},null,8,["modelValue","invalid"])]),_:1}),o(r,{class:"col-4 mt-4"},{default:t(()=>[o(u,{label:"Canal: Nivel Freático",type:"number",placeholder:"Canal: Nivel Freático","aria-describedby":"Nivel Freático",modelValue:n.form.channelNivelFreatico,"onUpdate:modelValue":l[13]||(l[13]=a=>n.form.channelNivelFreatico=a)},null,8,["modelValue"])]),_:1}),o(r,{class:"col-4 mt-4"},{default:t(()=>[o(u,{label:"Canal: Caudal",type:"number",placeholder:"Canal: Caudal","aria-describedby":"Caudal",modelValue:n.form.channelCaudal,"onUpdate:modelValue":l[14]||(l[14]=a=>n.form.channelCaudal=a),onInput:l[15]||(l[15]=a=>s.setTouched("channelCaudal")),feedback:"Rellene este campo por favor.",invalid:c.v$.form.channelCaudal.$error},null,8,["modelValue","invalid"])]),_:1}),o(r,{class:"col-4 mt-4"},{default:t(()=>[o(u,{label:"Canal: Totalizador",type:"number",placeholder:"Canal: Totalizador","aria-describedby":"Totalizador",modelValue:n.form.channelTotalizador,"onUpdate:modelValue":l[16]||(l[16]=a=>n.form.channelTotalizador=a),onInput:l[17]||(l[17]=a=>s.setTouched("channelTotalizador")),feedback:"Rellene este campo por favor.",invalid:c.v$.form.channelTotalizador.$error},null,8,["modelValue","invalid"])]),_:1}),o(r,{class:"col-6 mt-4"},{default:t(()=>[o(u,{label:"Canal: Altura Limnimétrica",type:"number",placeholder:"Canal: Altura limnimétrica","aria-describedby":"Altura Limnimétrica",modelValue:n.form.channelAlturaLimnimetrica,"onUpdate:modelValue":l[18]||(l[18]=a=>n.form.channelAlturaLimnimetrica=a),onInput:l[19]||(l[19]=a=>s.setTouched("channelAlturaLimnimetrica")),feedback:"Rellene este campo por favor.",invalid:c.v$.form.channelAlturaLimnimetrica.$error},null,8,["modelValue","invalid"])]),_:1})]),_:1})]),_:1})]),_:1}),o(D,null,{default:t(()=>[o(b,{color:"secondary",onClick:s.closeModal},{default:t(()=>[d(" Cerrar ")]),_:1},8,["onClick"]),o(b,{color:"primary",onClick:s.saveDevice},{default:t(()=>[d("Guardar")]),_:1},8,["onClick"])]),_:1})]),_:1},8,["visible","onClose"])}const K=F(G,[["render",J]]),Q={name:"AddConfig",props:{showModal:Boolean,device:Object},setup(){return{v$:S()}},data(){return{form:{id:"",enabled:!1,client_id:"",client_config_id:"",zeusCode:"",zeusName:"",dgaCode:"",channelNivelFreatico:"",channelCaudal:"",channelTotalizador:"",channelAlturaLimnimetrica:""},schedules:[],configs:[],configsByClient:[],clients:[],successMsg:"",success:!1}},validations(){return{form:{client_id:{required:f},client_config_id:{required:f},schedule_id:{required:f},zeusName:{required:f},zeusCode:{required:f},dgaCode:{required:f},channelCaudal:{required:f},channelAlturaLimnimetrica:{integer:w},channelTotalizador:{integer:w}}}},watch:{device:{handler(e){this.setDataDevice(e)},deep:!0,immediate:!0},showModal(e){e||this.$emit("update:showModal",!1)}},mounted(){this.getUsersConfig(),this.getSchedules(),this.getClients()},methods:{setTouched(e){(e=="client_id"||e=="all")&&this.v$.form.client_id.$touch(),(e=="client_config_id"||e=="all")&&this.v$.form.client_config_id.$touch(),(e=="schedule_id"||e=="all")&&this.v$.form.schedule_id.$touch(),(e=="zeusName"||e=="all")&&this.v$.form.zeusName.$touch(),(e=="zeusCode"||e=="all")&&this.v$.form.zeusCode.$touch(),(e=="dgaCode"||e=="all")&&this.v$.form.dgaCode.$touch(),(e=="channelCaudal"||e=="all")&&this.v$.form.channelCaudal.$touch(),(e=="channelAlturaLimnimetrica"||e=="all")&&this.v$.form.channelAlturaLimnimetrica.$touch(),(e=="channelTotalizador"||e=="all")&&this.v$.form.channelTotalizador.$touch()},closeModal(){this.$emit("cerrar"),this.success=!1},closeModalOutside(e){e.target===e.currentTarget&&this.closeModal()},setDataDevice(e){e&&(this.form.id=e.id,this.form.client_id=e.client_id,this.form.schedule_id=e.schedule_id,this.form.client_config_id=e.client_config_id,this.form.name=e.name,this.form.zeusCode=e.zeusCode,this.form.zeusName=e.zeusName,this.form.dgaCode=e.dgaCode,this.form.channelNivelFreatico=e.channelNivelFreatico,this.form.channelCaudal=e.channelCaudal,this.form.channelTotalizador=e.channelTotalizador,this.form.channelAlturaLimnimetrica=e.channelAlturaLimnimetrica,this.form.enabled=e.enabled,this.getConfigByClient(this.form.client_id))},async getSchedules(){try{const e=await h.get(this.$store.state.backendUrl+"/schedules",{headers:{"Content-Type":"application/json",Authorization:"Bearer "+this.$store.state.token}});this.schedules=e.data,console.log(this.schedules[0])}catch(e){console.error("Error en la solicitud a la API:",e),this.ShowError=!0}},async getUsersConfig(){try{const e=await h.get(this.$store.state.backendUrl+"/client_configs",{params:{client:1},headers:{"Content-Type":"application/json",Authorization:"Bearer "+this.$store.state.token}});this.configs=e.data.map(l=>({...l,clientName:l.client.name})),console.log(this.configs[0])}catch(e){console.error("Error en la solicitud a la API:",e),this.ShowError=!0}},async getConfigByClient(e){try{const l=await h.get(this.$store.state.backendUrl+"/client_configs",{params:{client:1,client_id:e},headers:{"Content-Type":"application/json",Authorization:"Bearer "+this.$store.state.token}});this.configsByClient=l.data,console.log(this.configsByClient)}catch(l){console.error("Error en la solicitud a la API:",l),this.ShowError=!0}},async getClients(){try{const e=await h.get(this.$store.state.backendUrl+"/clients",{headers:{"Content-Type":"application/json",Authorization:"Bearer "+this.$store.state.token}});this.clients=e.data}catch(e){console.error("Error en la solicitud a la API:",e),this.ShowError=!0}},saveDevice(){this.setTouched("all"),this.v$.$invalid||h.put(this.$store.state.backendUrl+"/devices/"+this.form.id,this.form,{headers:{"Content-Type":"application/json",Authorization:"Bearer "+this.$store.state.token}}).then(e=>{console.log(e),this.successMsg="Dispositivo actualizado correctamente.",this.success=!0}).catch(e=>{console.log("Error en post: ",e)})}}};function W(e,l,y,c,n,s){const z=i("CModalTitle"),p=i("CModalHeader"),_=i("CAlert"),v=i("CFormCheck"),r=i("CCol"),m=i("v-select"),u=i("CFormInput"),V=i("CRow"),C=i("CForm"),A=i("CModalBody"),b=i("CButton"),D=i("CModalFooter"),M=i("CModal");return k(),B(M,{size:"lg",visible:y.showModal,onClick:s.closeModalOutside},{default:t(()=>[o(p,null,{default:t(()=>[o(z,null,{default:t(()=>[d("Editar dispositivo")]),_:1})]),_:1}),o(A,null,{default:t(()=>[o(_,{color:"success",visible:n.success},{default:t(()=>[d(T(n.successMsg),1)]),_:1},8,["visible"]),o(C,null,{default:t(()=>[o(V,null,{default:t(()=>[o(r,{class:"col-12"},{default:t(()=>[o(v,{label:"Habilitado",class:"mr-5",modelValue:n.form.enabled,"onUpdate:modelValue":l[0]||(l[0]=a=>n.form.enabled=a)},null,8,["modelValue"])]),_:1}),o(r,{class:"col-12 mt-4"},{default:t(()=>[o(m,{modelValue:n.form.client_id,"onUpdate:modelValue":l[1]||(l[1]=a=>n.form.client_id=a),options:n.clients,reduce:a=>a.id,label:"name",placeholder:"Seleccione...",onInput:l[2]||(l[2]=a=>s.setTouched("client_id")),feedback:"Rellene este campo por favor.",invalid:c.v$.form.client_id.$error},null,8,["modelValue","options","reduce","invalid"])]),_:1}),o(r,{class:"col-6 mt-4"},{default:t(()=>[o(m,{modelValue:n.form.client_config_id,"onUpdate:modelValue":l[3]||(l[3]=a=>n.form.client_config_id=a),options:n.configsByClient,reduce:a=>a.id,placeholder:"Seleccione...",label:"zeusHost",onInput:l[4]||(l[4]=a=>s.setTouched("client_config_id")),feedback:"Rellene este campo por favor.",invalid:c.v$.form.client_config_id.$error},null,8,["modelValue","options","reduce","invalid"])]),_:1}),o(r,{class:"col-6 mt-4"},{default:t(()=>[o(m,{modelValue:n.form.schedule_id,"onUpdate:modelValue":l[5]||(l[5]=a=>n.form.schedule_id=a),options:n.schedules,reduce:a=>a.id,label:"name",placeholder:"Seleccione...",onInput:l[6]||(l[6]=a=>s.setTouched("schedule_id")),feedback:"Rellene este campo por favor.",invalid:c.v$.form.schedule_id.$error},null,8,["modelValue","options","reduce","invalid"])]),_:1}),o(r,{class:"col-12 mt-4"},{default:t(()=>[o(u,{label:"Nombre",type:"text",placeholder:"Nombre","aria-describedby":"nombre",modelValue:n.form.zeusName,"onUpdate:modelValue":l[7]||(l[7]=a=>n.form.zeusName=a),onInput:l[8]||(l[8]=a=>s.setTouched("zeusName")),feedback:"Rellene este campo por favor.",invalid:c.v$.form.zeusName.$error},null,8,["modelValue","invalid"])]),_:1}),o(r,{class:"col-6 mt-4"},{default:t(()=>[o(u,{label:"Zeus Código",type:"text",placeholder:"Zeus código","aria-describedby":"Zeus código",modelValue:n.form.zeusCode,"onUpdate:modelValue":l[9]||(l[9]=a=>n.form.zeusCode=a),onInput:l[10]||(l[10]=a=>s.setTouched("zeusCode")),feedback:"Rellene este campo por favor.",invalid:c.v$.form.zeusCode.$error},null,8,["modelValue","invalid"])]),_:1}),o(r,{class:"col-6 mt-4"},{default:t(()=>[o(u,{label:"DGA Código",type:"text",placeholder:"DGA código","aria-describedby":"DGA código",modelValue:n.form.dgaCode,"onUpdate:modelValue":l[11]||(l[11]=a=>n.form.dgaCode=a),onInput:l[12]||(l[12]=a=>s.setTouched("dgaCode")),feedback:"Rellene este campo por favor.",invalid:c.v$.form.dgaCode.$error},null,8,["modelValue","invalid"])]),_:1}),o(r,{class:"col-4 mt-4"},{default:t(()=>[o(u,{label:"Canal: Nivel Freático",type:"text",placeholder:"Canal: Nivel Freático","aria-describedby":"Nivel Freático",modelValue:n.form.channelNivelFreatico,"onUpdate:modelValue":l[13]||(l[13]=a=>n.form.channelNivelFreatico=a)},null,8,["modelValue"])]),_:1}),o(r,{class:"col-4 mt-4"},{default:t(()=>[o(u,{label:"Canal: Caudal",type:"text",placeholder:"Canal: Caudal","aria-describedby":"Caudal",modelValue:n.form.channelCaudal,"onUpdate:modelValue":l[14]||(l[14]=a=>n.form.channelCaudal=a),onInput:l[15]||(l[15]=a=>s.setTouched("channelCaudal")),feedback:"Rellene este campo por favor.",invalid:c.v$.form.channelCaudal.$error},null,8,["modelValue","invalid"])]),_:1}),o(r,{class:"col-4 mt-4"},{default:t(()=>[o(u,{label:"Canal: Totalizador",type:"text",placeholder:"Canal: Totalizador","aria-describedby":"Totalizador",modelValue:n.form.channelTotalizador,"onUpdate:modelValue":l[16]||(l[16]=a=>n.form.channelTotalizador=a),onInput:l[17]||(l[17]=a=>s.setTouched("channelTotalizador")),feedback:"Rellene este campo por favor.",invalid:c.v$.form.channelTotalizador.$error},null,8,["modelValue","invalid"])]),_:1}),o(r,{class:"col-4 mt-4"},{default:t(()=>[o(u,{label:"Canal: Altura Limnimétrica",type:"text",placeholder:"Canal: Altura limnimétrica","aria-describedby":"limnimetrica",modelValue:n.form.channelAlturaLimnimetrica,"onUpdate:modelValue":l[18]||(l[18]=a=>n.form.channelAlturaLimnimetrica=a),onInput:l[19]||(l[19]=a=>s.setTouched("channelAlturaLimnimetrica")),feedback:"Rellene este campo por favor.",invalid:c.v$.form.channelAlturaLimnimetrica.$error},null,8,["modelValue","invalid"])]),_:1})]),_:1})]),_:1})]),_:1}),o(D,null,{default:t(()=>[o(b,{color:"secondary",onClick:s.closeModal},{default:t(()=>[d(" Cerrar ")]),_:1},8,["onClick"]),o(b,{color:"primary",onClick:s.saveDevice},{default:t(()=>[d("Guardar")]),_:1},8,["onClick"])]),_:1})]),_:1},8,["visible","onClick"])}const X=F(Q,[["render",W]]),Y={name:"DeleteModal",emits:["closeDeleteModal"],props:{showDeleteModal:Boolean,device:Object},data(){return{fail:!1,success:!1}},methods:{closeModal(){this.$emit("closeDeleteModal"),this.fail=!1,this.success=!1},deleteDevice(){this.device.enabled&&(this.fail=!0),this.fail||h.delete(this.$store.state.backendUrl+"/devices/"+this.devices.id,{headers:{"Content-Type":"application/json",Authorization:"Bearer "+this.$store.state.token}}).then(e=>{console.log(e),this.success=!0}).catch(e=>{console.log("Error: ",e)})}}};function ee(e,l,y,c,n,s){const z=i("CModalTitle"),p=i("CModalHeader"),_=i("CModalBody"),v=i("CAlert"),r=i("CButton"),m=i("CModalFooter"),u=i("CModal");return k(),B(u,{visible:y.showDeleteModal,onClose:s.closeModal},{default:t(()=>[o(p,null,{default:t(()=>[o(z,null,{default:t(()=>[E(e.$slots,"modalTitle")]),_:3})]),_:3}),o(_,null,{default:t(()=>[E(e.$slots,"modalBody")]),_:3}),o(m,null,{default:t(()=>[o(v,{color:"danger",visible:n.fail},{default:t(()=>[d(" Para eliminar este dispositivo no debe estar habilitado. ")]),_:1},8,["visible"]),o(v,{color:"success",visible:n.success},{default:t(()=>[d(" Dispositivo eliminado exitósamente. ")]),_:1},8,["visible"]),o(r,{onClick:s.deleteDevice,color:"danger",class:"text-white"},{default:t(()=>[d("Eliminar ")]),_:1},8,["onClick"]),o(r,{color:"primary",onClick:s.closeModal},{default:t(()=>[d("Cancelar")]),_:1},8,["onClick"])]),_:1})]),_:3},8,["visible","onClose"])}const le=F(Y,[["render",ee]]),oe={name:"Devices",components:{SearchBarFilter:H,CIcon:x,AddDeviceModal:K,EditDeviceModal:X,DeleteDeviceModal:le},setup(){return{icon:P}},data(){return{devices:[],searchFilter:"",status:!1,showAddModal:!1,showEditModal:!1,showDeleteModal:!1,device_id:null}},computed:{filteredDevices(){let e=this.devices;return this.searchFilter!==""&&(e=e.filter(l=>l.zeusName.toLowerCase().includes(this.searchFilter.toLowerCase())||l.zeusCode.toLowerCase().includes(this.searchFilter.toLowerCase())||l.dgaCode.toLowerCase().includes(this.searchFilter.toLowerCase())||l.client.name.toLowerCase().includes(this.searchFilter.toLowerCase()))),e}},mounted(){this.getDevices()},methods:{handleSearch(e){this.searchFilter=e},editDevice(e){this.showEditModal=!0,this.device_id=e},deleteDevice(e){this.showDeleteModal=!0,this.device_id=e},addDevice(){this.showAddModal=!0},async getDevices(){try{const e=await h.get(this.$store.state.backendUrl+"/devices",{params:{client:1},headers:{"Content-Type":"application/json",Authorization:"Bearer "+this.$store.state.token}});this.devices=e.data,console.log("DEVICES: ",this.devices)}catch(e){console.error("Error en la solicitud a la API:",e),this.ShowError=!0}},onCloseAdd(){this.showAddModal=!1,this.getDevices()},onCloseEdit(){this.showEditModal=!1,this.getDevices()},onCloseDeleteModal(){this.showDeleteModal=!1,this.getDevices()}}};function te(e,l,y,c,n,s){const z=i("CIcon"),p=i("CButton"),_=i("CCol"),v=i("SearchBarFilter"),r=i("CRow"),m=i("CTableHeaderCell"),u=i("CTableRow"),V=i("CTableHead"),C=i("CTableDataCell"),A=i("CFormCheck"),b=i("font-awesome-icon"),D=i("CTableBody"),M=i("CTable"),a=i("AddDeviceModal"),L=i("EditDeviceModal"),$=i("DeleteDeviceModal");return k(),U(I,null,[o(r,{class:"mb-4"},{default:t(()=>[o(_,{class:"col-3 mt-4"},{default:t(()=>[o(p,{onClick:s.addDevice,color:"success",shape:"rounded-pill",variant:"outline"},{default:t(()=>[o(z,{icon:c.icon.cilPlus,size:"xl"},null,8,["icon"])]),_:1},8,["onClick"])]),_:1}),o(_,{class:"col-9"},{default:t(()=>[o(v,{onSearch:s.handleSearch},null,8,["onSearch"])]),_:1})]),_:1}),o(M,{class:"mt-5"},{default:t(()=>[o(V,null,{default:t(()=>[o(u,{color:"dark"},{default:t(()=>[o(m,{scope:"col"},{default:t(()=>[d("Cliente")]),_:1}),o(m,{scope:"col"},{default:t(()=>[d("Zeus Nombre")]),_:1}),o(m,{scope:"col"},{default:t(()=>[d("Zeus Código")]),_:1}),o(m,{scope:"col"},{default:t(()=>[d("DGA Código")]),_:1}),o(m,{scope:"col"},{default:t(()=>[d("Habilitado")]),_:1}),o(m,{scope:"col"},{default:t(()=>[d("Editar")]),_:1})]),_:1})]),_:1}),o(D,null,{default:t(()=>[(k(!0),U(I,null,j(s.filteredDevices,(g,ae)=>(k(),B(u,{key:g.id},{default:t(()=>[o(C,null,{default:t(()=>[d(T(g.client.name),1)]),_:2},1024),o(C,null,{default:t(()=>[d(T(g.zeusName),1)]),_:2},1024),o(C,null,{default:t(()=>[d(T(g.zeusCode),1)]),_:2},1024),o(C,null,{default:t(()=>[d(T(g.dgaCode),1)]),_:2},1024),o(C,{class:"text-center"},{default:t(()=>[o(A,{checked:g.enabled,disabled:""},null,8,["checked"])]),_:2},1024),o(C,null,{default:t(()=>[o(p,{onClick:R=>s.editDevice(g)},{default:t(()=>[o(b,{icon:"pen-to-square",size:"xl"})]),_:2},1032,["onClick"]),o(p,{onClick:R=>s.deleteDevice(g)},{default:t(()=>[o(b,{icon:"trash",size:"xl"})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),o(a,{showModal:n.showAddModal,onCerrar:s.onCloseAdd},null,8,["showModal","onCerrar"]),o(L,{showModal:n.showEditModal,device:n.device_id,onCerrar:s.onCloseEdit},null,8,["showModal","device","onCerrar"]),o($,{showDeleteModal:n.showDeleteModal,onCloseDeleteModal:s.onCloseDeleteModal,device:n.device_id},{modalTitle:t(()=>[d("Eliminar dispositivo: "),N("b",null,T(n.device_id.zeusName),1)]),modalBody:t(()=>[d(" ADVERTENCIA: Se eliminarán todos los datos de este dispositivo. ")]),modalFooter:t(()=>[]),_:1},8,["showDeleteModal","onCloseDeleteModal","device"])],64)}const fe=F(oe,[["render",te]]);export{fe as default};
